---

# gather_facts must be off when running this role: Python may be not yet installed

- name: Wait until SSH is available
  # Can't use wait_for
  local_action: "raw ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no ubuntu@{{ ansible_ssh_host }} '# Connected'"
  register: result
  changed_when: False
  until: result.stdout.find("OpenSSH") == -1
  retries: 10
  delay: 30

- name: Install Python
  raw: "apt-get -y -q install python"
  become: true
  retries: 10
  delay: 30
